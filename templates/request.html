{% extends "index.html" %}
{% block content %}
<div class="row" style="min-height: 400px; ">

  <!-- <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no"> -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
  <div class="col" id="map1"></div>
  <div class="col-1" ></div>
  <div class="col" id="map2"></div>
  <script>
    // TO MAKE THE MAP APPEAR YOU MUST
    // ADD YOUR ACCESS TOKEN FROM
    // https://account.mapbox.com
    mapboxgl.accessToken = '{{mapbox_token}}';
  const map = new mapboxgl.Map({
  container: 'map1', // container ID
  style: 'mapbox://styles/mapbox/streets-v11', // style URL
  center: [-96, 37.8], // starting position
  zoom: 3 // starting zoom
  });

  var geolocate = new mapboxgl.GeolocateControl({
      positionOptions: {
        enableHighAccuracy: true
      },
      fitBoundsOptions: {
        maxZoom: 15
      },
      // When active the map will receive updates to the device's location as it changes.
      trackUserLocation: true,
      // Draw an arrow next to the location dot to indicate which direction the device is heading.
      showUserHeading: true
    });
  
  // Add geolocate control to the map.
  map.addControl(geolocate);
  geolocate.on('geolocate', function(e) {
      var lonOrig = e.coords.longitude;
      var latOrig = e.coords.latitude
      document.getElementById('latOrig').value = latOrig;
      document.getElementById('lonOrig').value = lonOrig;
  });

  var geocoder = new MapboxGeocoder({
    accessToken: mapboxgl.accessToken,
    mapboxgl: mapboxgl
});
  map.addControl(
    geocoder, "top-left"
);

geocoder.on('result', function(e) {
      var latOrig = e.result.geometry.coordinates[0];
      var lonOrig = e.result.geometry.coordinates[1];
      document.getElementById('latOrig').value = latOrig;
      document.getElementById('lonOrig').value = lonOrig;
  });
  </script>
  <script>
    // TO MAKE THE MAP APPEAR YOU MUST
    // ADD YOUR ACCESS TOKEN FROM
    // https://account.mapbox.com
    mapboxgl.accessToken = '{{mapbox_token}}';
  const map2 = new mapboxgl.Map({
  container: 'map2', // container ID
  style: 'mapbox://styles/mapbox/streets-v11', // style URL
  center: [-96, 37.8], // starting position
  zoom: 3 // starting zoom
  });

  var geolocate2 = new mapboxgl.GeolocateControl({
      positionOptions: {
        enableHighAccuracy: true
      },
      fitBoundsOptions: {
        maxZoom: 15
      },
      // When active the map will receive updates to the device's location as it changes.
      trackUserLocation: true,
      // Draw an arrow next to the location dot to indicate which direction the device is heading.
      showUserHeading: true
    });
  
  // Add geolocate control to the map.
  map2.addControl(geolocate2);
  geolocate2.on('geolocate', function(e) {
      var latDest = e.coords.latitude;
      var lonDest = e.coords.longitude;
      document.getElementById('latDest').value = latDest;
      document.getElementById('lonDest').value = lonDest;
  });

  var geocoder2 = new MapboxGeocoder({
    accessToken: mapboxgl.accessToken,
    mapboxgl: mapboxgl
    });
  
  map2.addControl(
    geocoder2, "top-left"
    );

    geocoder2.on('result', function(e) {
      var latDest = e.result.geometry.coordinates[0];
      var lonDest = e.result.geometry.coordinates[1];
      document.getElementById('latDest').value = latDest;
      document.getElementById('lonDest').value = lonDest;
  });
  </script>

</div>

<form method='post'>
  <input id="latOrig" name="latOrig" type="hidden" />
  <input id="lonOrig" name="lonOrig" type="hidden" />
  <input id="latDest" name="latDest" type="hidden" />
  <input id="lonDest" name="lonDest" type="hidden" />
  <div class="form-group">
    <label for="deliveredBy">When do you need it delivered?</label>
    <input type="datetime-local" class="form-control" id="deliveredBy" aria-describedby="emailHelp" placeholder="Enter email">
  </div>
  <div class="form-group">
    <label for="exampleInputPassword1">Password</label>
    <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
  </div>
  <div class="form-check">
    <input type="checkbox" class="form-check-input" id="exampleCheck1">
    <label class="form-check-label" for="exampleCheck1">Check me out</label>
  </div>
  <button type="submit" class="btn btn-primary">Submit</button>
</form>
{% endblock %}